[gd_scene load_steps=48 format=3 uid="uid://bjaid4vbt3ref"]

[ext_resource type="Script" path="res://Scripts/player.gd" id="1_v18ko"]
[ext_resource type="Shader" path="res://Shaders/chromatic_aberration.gdshader" id="2_7ryb0"]
[ext_resource type="Script" path="res://addons/smoothing/smoothing_2d.gd" id="3_0fdtu"]
[ext_resource type="Shader" uid="uid://b6ehipwo7iqss" path="res://Shaders/damage_flash.tres" id="3_4p3gg"]
[ext_resource type="Texture2D" uid="uid://b7dicn3qtcdds" path="res://Sprites/playerAnimt.png" id="3_b7w5q"]
[ext_resource type="PackedScene" uid="uid://kaqdvuaks3ve" path="res://Scenes/shadow.tscn" id="4_f5tu7"]
[ext_resource type="Shader" path="res://Shaders/silhouette.gdshader" id="4_mojxy"]
[ext_resource type="Texture2D" uid="uid://dgne5kn683lgg" path="res://Sprites/bow_hands.png" id="5_mhsy8"]
[ext_resource type="Texture2D" uid="uid://bba2t6hs88v8r" path="res://Sprites/other_hand.png" id="5_mjf80"]
[ext_resource type="Shader" path="res://Shaders/vignette.gdshader" id="6_bfaih"]
[ext_resource type="Script" path="res://Scripts/AimLine.gd" id="7_l0xbb"]
[ext_resource type="Theme" uid="uid://b14htjma85o0x" path="res://default_theme.tres" id="8_krui2"]
[ext_resource type="Shader" path="res://Shaders/distort_filter.gdshader" id="8_rcjy6"]
[ext_resource type="Texture2D" uid="uid://cmlkj6snwq4oc" path="res://Sprites/hp_bar.png" id="9_f5pgl"]
[ext_resource type="Shader" path="res://Shaders/noise.gdshader" id="10_7kd1f"]
[ext_resource type="Shader" path="res://Shaders/drop_shadow.gdshader" id="11_w747l"]
[ext_resource type="Shader" path="res://Shaders/text_wave.gdshader" id="12_83huq"]
[ext_resource type="AudioStream" uid="uid://b0t482oxl36qr" path="res://Audio/Sounds/player_hurt.wav" id="18_871f3"]
[ext_resource type="AudioStream" uid="uid://dxn188hg86fkm" path="res://Audio/Sounds/shank.wav" id="19_q7v27"]
[ext_resource type="AudioStream" uid="uid://clokrif675cjk" path="res://Audio/Sounds/player_death.wav" id="20_eo2qx"]
[ext_resource type="AudioStream" uid="uid://dghwqo30g8qwi" path="res://Audio/Sounds/bow_shoot.wav" id="21_bke6g"]
[ext_resource type="AudioStream" uid="uid://bvo05jc1miron" path="res://Audio/Music/death_song.wav" id="22_gehas"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_jskx0"]
resource_local_to_scene = true
shader = ExtResource("3_4p3gg")
shader_parameter/flash_color = Color(1, 1, 1, 1)
shader_parameter/flash_modifier = 0.0
shader_parameter/silhouette_color = Color(0, 0, 0, 0.5)

[sub_resource type="Animation" id="Animation_dlfi6"]
resource_name = "CHARGING_BOW"
length = 2.0
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1, 1.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [0, 1, 2, 3]
}

[sub_resource type="Animation" id="Animation_gh01o"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_fhh4n"]
_data = {
"CHARGING_BOW": SubResource("Animation_dlfi6"),
"RESET": SubResource("Animation_gh01o")
}

[sub_resource type="ShaderMaterial" id="ShaderMaterial_3cxxl"]
shader = ExtResource("4_mojxy")
shader_parameter/silhouette_color = Color(0, 0, 0, 0.5)
shader_parameter/flash_active = false

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_3q7ug"]
radius = 8.6
height = 19.4

[sub_resource type="Animation" id="Animation_yl3ej"]
resource_name = "BOW_NO_ARMS"
length = 0.5
loop_mode = 1
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Smoothing2D/PlayerSprites/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [35]
}

[sub_resource type="Animation" id="Animation_hyruy"]
resource_name = "DEATH"
length = 4.0
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Smoothing2D/PlayerSprites/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1, 1.5, 2, 2.5, 3, 3.5),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [22, 23, 24, 25, 26, 27, 28, 29]
}

[sub_resource type="Animation" id="Animation_g5ee2"]
resource_name = "IDLE"
length = 2.0
loop_mode = 1
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Smoothing2D/PlayerSprites/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1, 1.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [10, 11, 12, 13]
}

[sub_resource type="Animation" id="Animation_wsv3r"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Smoothing2D/PlayerSprites/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}

[sub_resource type="Animation" id="Animation_hfto3"]
resource_name = "RUN"
length = 5.0
loop_mode = 1
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Smoothing2D/PlayerSprites/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
}

[sub_resource type="Animation" id="Animation_7t4hk"]
resource_name = "RUN_DOWN"
length = 2.0
loop_mode = 1
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Smoothing2D/PlayerSprites/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1, 1.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [14, 15, 16, 17]
}

[sub_resource type="Animation" id="Animation_r84ku"]
resource_name = "RUN_UP"
length = 2.0
loop_mode = 1
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Smoothing2D/PlayerSprites/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1, 1.5),
"transitions": PackedFloat32Array(1, 1, 1, 1),
"update": 1,
"values": [18, 19, 20, 21]
}

[sub_resource type="Animation" id="Animation_axqnt"]
resource_name = "SHANK"
length = 3.0
step = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Smoothing2D/PlayerSprites/Sprite2D:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5, 1, 1.5, 2, 2.5),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1),
"update": 1,
"values": [30, 31, 32, 33, 34, 35]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_ot4rl"]
_data = {
"BOW_NO_ARMS": SubResource("Animation_yl3ej"),
"DEATH": SubResource("Animation_hyruy"),
"IDLE": SubResource("Animation_g5ee2"),
"RESET": SubResource("Animation_wsv3r"),
"RUN": SubResource("Animation_hfto3"),
"RUN_DOWN": SubResource("Animation_7t4hk"),
"RUN_UP": SubResource("Animation_r84ku"),
"SHANK": SubResource("Animation_axqnt")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_dnyfx"]
size = Vector2(36, 49)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_qanra"]
shader = ExtResource("6_bfaih")
shader_parameter/inner_radius = 0.1
shader_parameter/outer_radius = 1.0
shader_parameter/vignette_strength = 1.0
shader_parameter/dither_strength = 0.03
shader_parameter/vignette_color = null

[sub_resource type="ShaderMaterial" id="ShaderMaterial_p7rba"]
shader = ExtResource("8_rcjy6")
shader_parameter/progress = 0.546
shader_parameter/bg_color = Color(1, 1, 1, 0.282353)
shader_parameter/wave_1_color = Color(0.288518, 0.288518, 0.288518, 0.941176)
shader_parameter/wave_2_color = Color(0, 0, 0, 0.941176)
shader_parameter/wave_1_speed = -1.0
shader_parameter/wave_2_speed = 1.0
shader_parameter/wave_amplitude = 0.03
shader_parameter/bg_opacity = 0.064

[sub_resource type="ShaderMaterial" id="ShaderMaterial_0c6kw"]
shader = ExtResource("11_w747l")
shader_parameter/borderScale = 1.0
shader_parameter/offset = Vector2(-5, -5)
shader_parameter/color = Color(0, 0, 0, 0.498039)
shader_parameter/debug = false

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_ilf5k"]
bg_color = Color(0, 0, 0, 0)
border_width_left = 3
border_width_top = 3
border_width_right = 3
border_width_bottom = 3
border_color = Color(0.886262, 0.886262, 0.886261, 1)

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_173ri"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_mtvyi"]
shader = ExtResource("10_7kd1f")
shader_parameter/uOpacity = 0.0

[sub_resource type="ShaderMaterial" id="ShaderMaterial_mkd0g"]
shader = ExtResource("12_83huq")
shader_parameter/height = 5.0
shader_parameter/frequency = 22.155
shader_parameter/speed = 3.39

[sub_resource type="ShaderMaterial" id="ShaderMaterial_e42tv"]
shader = ExtResource("12_83huq")
shader_parameter/height = 3.0
shader_parameter/frequency = 20.0
shader_parameter/speed = 3.0

[sub_resource type="ShaderMaterial" id="ShaderMaterial_tjw4g"]
shader = ExtResource("2_7ryb0")
shader_parameter/r_displacement = Vector2(3, 0)
shader_parameter/g_displacement = Vector2(0, 0)
shader_parameter/b_displacement = Vector2(-3, 0)
shader_parameter/height = 0.7
shader_parameter/width = 0.5
shader_parameter/fade = 0.7

[node name="Player" type="CharacterBody2D"]
y_sort_enabled = true
collision_layer = 3
script = ExtResource("1_v18ko")

[node name="Smoothing2D" type="Node2D" parent="."]
script = ExtResource("3_0fdtu")
target = NodePath("..")

[node name="PlayerSprites" type="Node2D" parent="Smoothing2D"]

[node name="OtherHand" type="Sprite2D" parent="Smoothing2D/PlayerSprites"]
visible = false
position = Vector2(-2, -7)
texture = ExtResource("5_mjf80")
offset = Vector2(12, 0)

[node name="Sprite2D" type="Sprite2D" parent="Smoothing2D/PlayerSprites"]
material = SubResource("ShaderMaterial_jskx0")
texture = ExtResource("3_b7w5q")
hframes = 37

[node name="BowOnly" type="Sprite2D" parent="Smoothing2D/PlayerSprites"]
visible = false
position = Vector2(-2, -4)
texture = ExtResource("5_mhsy8")
offset = Vector2(13.5, 0)
hframes = 4

[node name="AnimationPlayer" type="AnimationPlayer" parent="Smoothing2D/PlayerSprites/BowOnly"]
libraries = {
"": SubResource("AnimationLibrary_fhh4n")
}
speed_scale = 2.0

[node name="ArrowSpawnPoint" type="Marker2D" parent="Smoothing2D/PlayerSprites/BowOnly"]
position = Vector2(23, -0.5)

[node name="AimLine" type="Node2D" parent="Smoothing2D/PlayerSprites/BowOnly"]
z_index = 200
position = Vector2(25, 0)
script = ExtResource("7_l0xbb")

[node name="Shadow" parent="Smoothing2D" node_paths=PackedStringArray("sprite") instance=ExtResource("4_f5tu7")]
position = Vector2(0, 48)
sprite = NodePath("../PlayerSprites/Sprite2D")

[node name="SilhouetteSprite" type="Sprite2D" parent="Smoothing2D"]
visible = false
z_index = 100
material = SubResource("ShaderMaterial_3cxxl")
texture = ExtResource("3_b7w5q")
hframes = 22

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2(0, 8)
shape = SubResource("CapsuleShape2D_3q7ug")

[node name="Camera2D" type="Camera2D" parent="."]
zoom = Vector2(2, 2)
position_smoothing_enabled = true

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_ot4rl")
}
speed_scale = 8.0

[node name="AttackRange" type="Area2D" parent="."]
position = Vector2(18, 7.5)
collision_layer = 3
collision_mask = 3
metadata/_edit_group_ = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="AttackRange"]
shape = SubResource("RectangleShape2D_dnyfx")

[node name="CanvasLayer" type="CanvasLayer" parent="."]

[node name="Vignette" type="ColorRect" parent="CanvasLayer"]
material = SubResource("ShaderMaterial_qanra")
offset_right = 1280.0
offset_bottom = 960.0

[node name="UI" type="Control" parent="CanvasLayer"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="HealthBar" type="Control" parent="CanvasLayer/UI"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="Effect" type="ColorRect" parent="CanvasLayer/UI/HealthBar"]
material = SubResource("ShaderMaterial_p7rba")
layout_mode = 0
offset_left = 54.0
offset_top = 60.0
offset_right = 106.0
offset_bottom = 264.0
scale = Vector2(0.84, 1)

[node name="HPBar" type="NinePatchRect" parent="CanvasLayer/UI/HealthBar"]
material = SubResource("ShaderMaterial_0c6kw")
layout_mode = 1
offset_left = 150.0
offset_top = 24.0
offset_right = 427.0
offset_bottom = 174.0
rotation = 1.5708
texture = ExtResource("9_f5pgl")
patch_margin_left = 64
patch_margin_top = 64
patch_margin_right = 64
patch_margin_bottom = 64

[node name="HealthText" type="Label" parent="CanvasLayer/UI/HealthBar"]
visible = false
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = 14.0
offset_top = 240.0
offset_right = 99.0
offset_bottom = 274.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("8_krui2")
theme_override_colors/font_color = Color(1, 1, 1, 1)
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 7
theme_override_font_sizes/font_size = 36
text = "10/10"
horizontal_alignment = 1
vertical_alignment = 1

[node name="HealthBar" type="ProgressBar" parent="CanvasLayer/UI/HealthBar"]
visible = false
layout_mode = 0
offset_left = 40.0
offset_top = 40.0
offset_right = 324.32
offset_bottom = 80.65
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 8
theme_override_font_sizes/font_size = 31
theme_override_styles/background = SubResource("StyleBoxFlat_ilf5k")
theme_override_styles/fill = SubResource("StyleBoxEmpty_173ri")
max_value = 10.0
step = 1.0
value = 7.0
show_percentage = false

[node name="DeathScreen" type="Control" parent="CanvasLayer/UI"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="Timer" type="Timer" parent="CanvasLayer/UI/DeathScreen"]
wait_time = 1.4
one_shot = true

[node name="ColorRect" type="ColorRect" parent="CanvasLayer/UI/DeathScreen"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0)

[node name="noise" type="ColorRect" parent="CanvasLayer/UI/DeathScreen"]
material = SubResource("ShaderMaterial_mtvyi")
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0)

[node name="DeathText" type="RichTextLabel" parent="CanvasLayer/UI/DeathScreen"]
modulate = Color(1, 1, 1, 0)
material = SubResource("ShaderMaterial_mkd0g")
clip_contents = false
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -357.5
offset_top = -50.0
offset_right = 357.5
offset_bottom = 50.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("8_krui2")
theme_override_colors/font_outline_color = Color(0, 0, 0, 1)
theme_override_constants/outline_size = 15
theme_override_font_sizes/normal_font_size = 106
bbcode_enabled = true
text = "YOU PERISHED"
autowrap_mode = 0

[node name="RestartText" type="Label" parent="CanvasLayer/UI/DeathScreen"]
modulate = Color(1, 1, 1, 0)
material = SubResource("ShaderMaterial_e42tv")
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -427.0
offset_top = 31.0
offset_right = 427.0
offset_bottom = 131.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("8_krui2")
theme_override_constants/outline_size = 15
theme_override_font_sizes/font_size = 36
text = "Press R to restart"
horizontal_alignment = 1
vertical_alignment = 1

[node name="ChromaticAberration" type="ColorRect" parent="CanvasLayer"]
material = SubResource("ShaderMaterial_tjw4g")
offset_right = 1280.0
offset_bottom = 960.0

[node name="FadeTransition" type="ColorRect" parent="CanvasLayer"]
offset_right = 1280.0
offset_bottom = 960.0
color = Color(0, 0, 0, 0)

[node name="DamageFlashTimer" type="Timer" parent="."]
wait_time = 0.15
one_shot = true

[node name="PlayerHurt" type="AudioStreamPlayer" parent="."]
stream = ExtResource("18_871f3")
volume_db = -25.0

[node name="Shank" type="AudioStreamPlayer" parent="."]
stream = ExtResource("19_q7v27")
volume_db = -30.0

[node name="PlayerDeath" type="AudioStreamPlayer" parent="."]
stream = ExtResource("20_eo2qx")
volume_db = -30.0

[node name="BowShoot" type="AudioStreamPlayer" parent="."]
stream = ExtResource("21_bke6g")
volume_db = -30.0

[node name="DeathSong" type="AudioStreamPlayer" parent="."]
stream = ExtResource("22_gehas")
volume_db = -15.0

[connection signal="animation_finished" from="AnimationPlayer" to="." method="_on_animation_player_animation_finished"]
[connection signal="timeout" from="DamageFlashTimer" to="." method="_on_damage_flash_timer_timeout"]
